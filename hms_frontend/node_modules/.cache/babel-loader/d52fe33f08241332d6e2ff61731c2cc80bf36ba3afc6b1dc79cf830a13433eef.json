{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport Button from 'primevue/button';\nimport Dialog from 'primevue/dialog';\nimport { ref } from 'vue';\nimport InputText from 'primevue/inputtext';\nimport newsListShow from './newsListShow.vue';\nimport { useConfirm } from \"primevue/useconfirm\";\nimport { useToast } from \"primevue/usetoast\";\nimport ConfirmDialog from 'primevue/confirmdialog';\nimport Toast from 'primevue/toast';\nimport axios from 'axios';\nexport default {\n  __name: 'newsShow',\n  setup(__props, {\n    expose\n  }) {\n    expose();\n    let visible = ref(false);\n    let introText = ref(\"\");\n    let itemsToBeDeleted = ref([]);\n    let token = \"eyJhbGciOiJIUzI1NiJ9.eyJub3dMb2dnZWRJblR5cGUiOiJub3dMb2dnZWRJblR5cGVBZG1pbiIsIm5vd0xvZ2dlZEluSWQiOiIxIiwiaWF0IjoxNjg0NzQ2OTQxLCJleHAiOjE2ODY1NDY5NDF9.npgDMKJW-7zrsoAlBmdtuWbQNqzhi_0bBzjXieLqKu8\";\n    let files = [];\n    let imageUrl = ref(\"\");\n    const confirm = useConfirm();\n    const toast = useToast();\n    function getFiles(event) {\n      const file = event.target.files[0];\n      console.log('bbbbbbbbbbb');\n      console.log(file);\n      // const formData = new FormData();\n      // formData.append(\"name\",token);\n      // formData.append(\"file\",file);\n\n      //将上传的文件存到数据库\n      if (file) {\n        axios.post('https://pz.al/api/upload', {\n          image: file\n        }, {\n          params: {},\n          headers: {\n            \"Content-Type\": \"multipart/form-data\"\n          }\n        }).then(response => {\n          console.log(response.data.data.url);\n          imageUrl.value = response.data.data.url;\n        });\n      } else {\n        console.error('文件不存在');\n      }\n    }\n    function upload() {\n      axios({\n        method: 'post',\n        url: 'http://121.199.161.134:8080/addNews',\n        params: {\n          token: token\n        },\n        data: {\n          img: imageUrl.value,\n          body: introText.value\n        }\n      }).then(res => {\n        console.log(res);\n        toast.add({\n          severity: 'info',\n          summary: '添加新闻',\n          detail: '已将新闻上传至列表！',\n          life: 3000\n        });\n      });\n      window.location.reload();\n    }\n    function getSelectedItems(params) {\n      console.log(params);\n      itemsToBeDeleted = params;\n    }\n    const confirm2 = () => {\n      console.log(itemsToBeDeleted);\n      if (itemsToBeDeleted.value.length == 0) {\n        window.alert(\"未选择任何新闻！\");\n      } else {\n        confirm.require({\n          message: '确定删除选中的全部新闻吗？',\n          header: '删除新闻',\n          acceptClass: 'p-button-danger',\n          accept: () => {\n            console.log(itemsToBeDeleted.value);\n            let array_ = itemsToBeDeleted.value;\n            let ret = [];\n            for (let i = 0; i < array_.length; i++) {\n              ret.push(array_[i].id);\n            }\n            console.log(ret);\n            axios({\n              method: 'delete',\n              url: 'http://121.199.161.134:8080/deleteNews',\n              params: {\n                token: token\n              },\n              data: {\n                id: ret\n              }\n            }).then(res => {\n              console.log(res);\n            });\n            window.location.reload();\n            toast.add({\n              severity: 'info',\n              summary: '删除新闻',\n              detail: '已删除全部选中新闻！',\n              life: 3000\n            });\n          }\n        });\n      }\n    };\n    const __returned__ = {\n      get visible() {\n        return visible;\n      },\n      set visible(v) {\n        visible = v;\n      },\n      get introText() {\n        return introText;\n      },\n      set introText(v) {\n        introText = v;\n      },\n      get itemsToBeDeleted() {\n        return itemsToBeDeleted;\n      },\n      set itemsToBeDeleted(v) {\n        itemsToBeDeleted = v;\n      },\n      get token() {\n        return token;\n      },\n      set token(v) {\n        token = v;\n      },\n      get files() {\n        return files;\n      },\n      set files(v) {\n        files = v;\n      },\n      get imageUrl() {\n        return imageUrl;\n      },\n      set imageUrl(v) {\n        imageUrl = v;\n      },\n      confirm,\n      toast,\n      getFiles,\n      upload,\n      getSelectedItems,\n      confirm2,\n      get Button() {\n        return Button;\n      },\n      get Dialog() {\n        return Dialog;\n      },\n      ref,\n      get InputText() {\n        return InputText;\n      },\n      newsListShow,\n      get useConfirm() {\n        return useConfirm;\n      },\n      get useToast() {\n        return useToast;\n      },\n      get ConfirmDialog() {\n        return ConfirmDialog;\n      },\n      get Toast() {\n        return Toast;\n      },\n      get axios() {\n        return axios;\n      }\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["Button","Dialog","ref","InputText","newsListShow","useConfirm","useToast","ConfirmDialog","Toast","axios","visible","introText","itemsToBeDeleted","token","files","imageUrl","confirm","toast","getFiles","event","file","target","console","log","post","image","params","headers","then","response","data","url","value","error","upload","method","img","body","res","add","severity","summary","detail","life","window","location","reload","getSelectedItems","confirm2","length","alert","require","message","header","acceptClass","accept","array_","ret","i","push","id"],"sources":["D:/Desktop/HMS-front-end/hms_frontend/src/manager/components/newsManage/newsShow.vue"],"sourcesContent":["<template>\r\n    <Toast />\r\n    <Button label=\"添加新闻\" @click=\"visible=true\" style=\"position: absolute; margin: 20px; left: 15%;\" />\r\n    <Dialog v-model:visible=\"visible\" header=\"添加新闻\" style=\"width:60%; position: absolute;\">\r\n        <table style=\"left: 5%; position: relative;\">\r\n            <tr>\r\n                <td style=\"width: 30%;\">上传图片：</td>\r\n                <td style=\"width: 60%;\">\r\n                    <div>\r\n                        <div>\r\n                            <input @change=\"getFiles($event)\" name=\"files\" type=\"file\" /><br />\r\n                        </div>\r\n                    </div>\r\n                </td>\r\n            </tr>\r\n            <br/>\r\n            <tr>\r\n                <td>介绍文字：</td>\r\n                <td>\r\n                    <InputText type=\"text\" v-model=\"introText\" style=\"width: 100%;\"/>\r\n                </td>\r\n            </tr>\r\n        </table>\r\n        <br/><br/>\r\n        <Button @click=\"upload\" type=\"submit\" style=\"position: absolute; left: 50%; transform: translate(0, -50%);\">上传</Button>\r\n        <br/>\r\n    </Dialog>\r\n    <Toast />\r\n    <ConfirmDialog></ConfirmDialog>\r\n    <div>\r\n        <Button @click=\"confirm2()\" label=\"删除新闻\" style=\"position: absolute; margin: 20px; left: 25%;\"></Button>\r\n    </div>\r\n    <div style=\"position: absolute; top: 220px; align-items: center; height: fit-content; max-height: 500px; overflow: auto;\">\r\n        <newsListShow @select-items=\"getSelectedItems\"/>\r\n    </div>\r\n</template>\r\n\r\n<script setup>\r\nimport Button from 'primevue/button';\r\nimport Dialog from 'primevue/dialog';\r\nimport { ref } from 'vue';\r\nimport InputText from 'primevue/inputtext';\r\nimport newsListShow from './newsListShow.vue'\r\nimport { useConfirm } from \"primevue/useconfirm\";\r\nimport { useToast } from \"primevue/usetoast\";\r\nimport ConfirmDialog from 'primevue/confirmdialog';\r\nimport Toast from 'primevue/toast';\r\nimport axios from 'axios';\r\n\r\nlet visible = ref(false)\r\nlet introText = ref(\"\")\r\nlet itemsToBeDeleted = ref([])\r\nlet token = \"eyJhbGciOiJIUzI1NiJ9.eyJub3dMb2dnZWRJblR5cGUiOiJub3dMb2dnZWRJblR5cGVBZG1pbiIsIm5vd0xvZ2dlZEluSWQiOiIxIiwiaWF0IjoxNjg0NzQ2OTQxLCJleHAiOjE2ODY1NDY5NDF9.npgDMKJW-7zrsoAlBmdtuWbQNqzhi_0bBzjXieLqKu8\"\r\nlet files = []\r\nlet imageUrl = ref(\"\")\r\nconst confirm = useConfirm();\r\nconst toast = useToast();\r\n\r\nfunction getFiles(event) {\r\n    const file = event.target.files[0];\r\n    \r\n    console.log('bbbbbbbbbbb');\r\n    console.log(file);\r\n    // const formData = new FormData();\r\n    // formData.append(\"name\",token);\r\n    // formData.append(\"file\",file);\r\n    \r\n    //将上传的文件存到数据库\r\n    if (file) {\r\n        axios.post('https://pz.al/api/upload', {image:file}, {\r\n            params:{\r\n\r\n            },\r\n            headers:{\r\n                \"Content-Type\":\"multipart/form-data\"\r\n            }\r\n        }).then(response => {\r\n            console.log(response.data.data.url);\r\n            imageUrl.value = response.data.data.url\r\n        })\r\n    }\r\n    else {\r\n        console.error('文件不存在')\r\n    }\r\n}\r\n\r\nfunction upload()\r\n{\r\n    axios({\r\n        method: 'post',\r\n        url: 'http://121.199.161.134:8080/addNews',\r\n        params: {\r\n            token: token\r\n        },\r\n        data: {\r\n            img: imageUrl.value,\r\n            body: introText.value\r\n        }\r\n    }).then((res)=>{\r\n        console.log(res)\r\n        toast.add({ severity: 'info', summary: '添加新闻', detail: '已将新闻上传至列表！', life: 3000 });\r\n    })\r\n    window.location.reload()\r\n}\r\n\r\nfunction getSelectedItems(params)\r\n{\r\n    console.log(params)\r\n    itemsToBeDeleted = params\r\n}\r\n\r\nconst confirm2 = () => {\r\n    console.log(itemsToBeDeleted)\r\n    if(itemsToBeDeleted.value.length==0)\r\n    {\r\n        window.alert(\"未选择任何新闻！\")\r\n    }\r\n    else\r\n    {\r\n        confirm.require({\r\n            message: '确定删除选中的全部新闻吗？',\r\n            header: '删除新闻',\r\n            acceptClass: 'p-button-danger',\r\n            accept: () => {\r\n                console.log(itemsToBeDeleted.value)\r\n                let array_ = itemsToBeDeleted.value\r\n                let ret = []\r\n                for(let i=0; i<array_.length; i++)\r\n                {\r\n                    ret.push(array_[i].id)\r\n                }\r\n                console.log(ret)\r\n                axios({\r\n                    method: 'delete',\r\n                    url: 'http://121.199.161.134:8080/deleteNews',\r\n                    params: {\r\n                        token: token\r\n                    },\r\n                    data: {\r\n                        id: ret\r\n                    }\r\n                }).then((res)=>{\r\n                    console.log(res)\r\n                })\r\n                window.location.reload()\r\n                toast.add({ severity: 'info', summary: '删除新闻', detail: '已删除全部选中新闻！', life: 3000 });\r\n            }\r\n        });\r\n    }\r\n};\r\n\r\n\r\n</script>"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}